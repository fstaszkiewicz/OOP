# ROZPISKA WYMAGAŃ 

| KRYTERIUM | PUNKTY | OPIS                                                                                                                                                  | GDZIE SĄ TESTY (plik -> testy)                                                                                                                                                                                                                          |
|---|---:|-------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Ograniczenia techniczne** | **4** |                                                                                                                                                       |                                                                                                                                                                                                                                                         |
| Zakaz Stream API | 1 | Brak `.stream()` oraz operacji Stream API; operacje na kolekcjach wykonane pętlami `for/while/enhanced-for` i `if`.                                   | `uruchomienie testów`                                                                                                                                                                                                                                    |
| Zakaz Java Records | 1 | Brak `record`; wszystkie modele to klasy POJO z prywatnymi polami i metodami dostępowymi.                                                             |                                                                                                                                                                                                                                                         |
| Typizacja (Enumy) | 1 | Stałe domenowe jako enumy (np. `AssetType`, `OrderType`), brak sterowania logiką przez Stringi typu `"BUY"`/`"SHARE"`.                                | `OrderPriorityQueueTest.java` -> `buyLimitOrderCloserToMarketShouldBeOnTop()`                                                                                                                                                                           |
| Biblioteki | 1 | Brak frameworków zewnętrznych (poza JUnit 5).                                                                                                         | `pom.xml` + `uruchomienie testow`                                                                                                                                                                                                                       |
| **Wymagania funkcjonalne** | **5** |                                                                                                                                                       |                                                                                                                                                                                                                                                         |
| Partie Zakupowe (Purchase Lots) | 1 | Portfel przechowuje historię partii zakupu (data, ilość, cena zakupu) zamiast średniej ceny; loty są podstawą do FIFO.                                | `FifoSellTest.java` -> `sellFifo_shouldCreateTwoSaleLines()`; `PortfolioPersistenceTest.java` -> `saveAndLoad_shouldPreserveAaplTotalQuantity()`                                                                                                        |
| Struktury danych | 1 | O(1) lookup pozycji po tickerze (HashMap); watchlist bez duplikatów (HashSet); kolejka zleceń priorytetowa (PriorityQueue + Comparator).              | `OrderPriorityQueueTest.java` -> `buyLimitOrderCloserToMarketShouldBeOnTop()`                                                                                                                                                                           |
| Kolejka FIFO (sprzedaż) | 1 | FIFO: sprzedaż zaczyna od najstarszej partii; obsługa sprzedaży przez wiele partii oraz sprzedaży częściowej.                                         | `FifoSellTest.java` -> `sellFifo_shouldCalculateTotalProfit()`, `fifoPartialSellShouldDecreaseFirstLotQuantity()`                                                                                                                                       |
| Raporty sprzedaży (P&L) | 1 | Sprzedaż zwraca raport: linie zużytych partii (`SaleLine`) + suma P&L (`SaleResult.totalProfit`).                                                     | `FifoSellTest.java` -> `sellFifo_shouldCreateTwoSaleLines()`, `sellFifo_firstLineShouldConsumeTenFromFirstLot()`, `sellFifo_secondLineShouldConsumeFiveFromSecondLot()`                                                                                 |
| Persystencja (I/O) | 1 | Zapis/odczyt stanu portfela do pliku tekstowego (CASH + ASSET + LOT) + walidacja integralności (mismatch sum LOT != QTY -> `DataIntegrityException`). | `PortfolioPersistenceTest.java` -> `saveAndLoad_shouldPreserveCash()`, `saveAndLoad_shouldPreservePositionsCount()`, `saveAndLoad_shouldContainAaplPosition()`, `saveAndLoad_shouldPreserveAaplTotalQuantity()`, `load_shouldThrowWhenLotSumMismatch()` |
| **Weryfikacja (QA)** | **6** |                                                                                                                                                       |                                                                                                                                                                                                                                                         |
| Testy kolejki FIFO | 1 | Test referencyjny FIFO: wiele partii + poprawny P&L + poprawne zużycie lotów (rozbite na “1 test = 1 assert”).                                        | `FifoSellTest.java` -> `sellFifo_shouldReturnSoldQuantity()`, `sellFifo_shouldCalculateTotalProfit()`, `sellFifo_shouldCreateTwoSaleLines()`, `sellFifo_firstLineShouldConsumeTenFromFirstLot()`, `sellFifo_secondLineShouldConsumeFiveFromSecondLot()` |
| Testy kolejki priorytetowej | 1 | Priorytet BUY-limit: wyższy limit bliżej rynku jest pierwszy w kolejce.                                                                               | `OrderPriorityQueueTest.java` -> `buyLimitOrderCloserToMarketShouldBeOnTop()`                                                                                                                                                                           |
| Testy parsera / persystencji | 1 | Parser wczytuje poprawny format oraz wykrywa uszkodzenie integralności danych (mismatch sum LOT).                                                     | `PortfolioPersistenceTest.java` -> `saveAndLoad_shouldPreserveCash()`, `load_shouldThrowWhenLotSumMismatch()`                                                                                                                                           |
| Testy wyjątków | 1 | Brak gotówki przy zakupie -> `InsufficientFundsException`; sprzedaż bez pozycji -> `InsufficientHoldingsException`.                                   | `PortfolioExceptionsTest.java` -> `acquireShouldThrowInsufficientFunds()`, `sellShouldThrowWhenNoPosition()`                                                                                                                                            |
| Testy warunków brzegowych | 1 | Sprzedaż częściowa: zmniejsza ilość w pierwszym locie (lot nie znika, tylko redukuje quantity).                               | `FifoSellTest.java` -> `fifoPartialSellShouldDecreaseFirstLotQuantity()`                                                                                                                                                                                |
| Pełne pokrycie testami | 1 | Każda główna funkcja (FIFO, PQ, I/O, wyjątki) posiada testy; każdy test ma 1 asercję.                                                                 | `FifoSellTest.java`, `OrderPriorityQueueTest.java`, `PortfolioPersistenceTest.java`, `PortfolioExceptionsTest.java`                                                                                                                                     |
```